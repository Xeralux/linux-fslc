/*
 * Copyright (C) 2013 Sensity Systems, Inc.
 *
 * CONFIDENTIAL AND PROPRIETARY.
 */

/dts-v1/;

#include "imx6dl.dtsi"

/ {
	model = "Sensity Systems Medianode";
	compatible = "sensity,medianode", "fsl,imx6dl";

	memory {
		reg = <0x10000000 0x40000000>;
	};

	pwm-floods {
		compatible = "pwm-leds";

		flood0 {
			label = "medianode::flood0";
			pwms = <&pwm1 0 20000>;	/*  50KHz cycle  */
			max-brightness = <255>;
		};
		flood1 {
			label = "medianode::flood1";
			pwms = <&pwm2 0 20000>;	/*  50KHz cycle  */
			max-brightness = <255>;
		};
	};
};

/*  Use native chipselects for all SPI channels.  */
&ecspi1 {
	/*  All signals go out on connector J23.  */
	fsl,spi-num-chipselects = <1>;
	cs-gpios = <0>;		// <&gpio4 9 0>;	/*  KEY_ROW1  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_ecspi1_mn>;
	status = "okay";

	spidev@0 {
		compatible = "spidev";
		spi-max-frequency = <12000000>;
		reg = <0>;
	};
};

&ecspi2 {
	/*  All signals go out on connector J23.  */
	fsl,spi-num-chipselects = <1>;
	cs-gpios = <0>;		// <&gpio2 26 0>;	/*  EIM_RW  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_ecspi2_mn>;
	status = "okay";

	spidev@0 {
		compatible = "spidev";
		spi-max-frequency = <12000000>;
		reg = <0>;
	};
};

&ecspi3 {
	fsl,spi-num-chipselects = <1>;
	cs-gpios = <0>;		// <&gpio4 24 0>;	/*  DISP0_DAT03  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_ecspi3_mn>;
	status = "okay";

	spi_uart: sc16is7x2@0 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "nxp,sc16is7x2";
		spi-max-frequency = <4000000>;
		reg = <0>;
		uartclk = <1843200>;
		rst_gpio = <&gpio6 16 1>;
		uart_base = <0>;
		gpio_base = <224>;	/*  <&gpio7 0 0> ?  */
		interrupt-parent = <&gpio1>;
		interrupts = <0 2>;
	};
	
//	/*  Entry for basic bus testing.  */
//	spidev@0 {
//		compatible = "spidev";
//		spi-max-frequency = <12000000>;
//		reg = <0>;
//	};
};

&ecspi4 {
	/*  All signals go out on connector J23.  */
	fsl,spi-num-chipselects = <1>;
	cs-gpios = <0>;		// <&gpio3 20 0>;	/*  EIM_D20  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_ecspi4_mn>;
	status = "okay";

	spidev@0 {
		compatible = "spidev";
		spi-max-frequency = <12000000>;
		reg = <0>;
	};
};

&i2c1 {
	clock-frequency = <400000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c1_2>;	/*  "CSI DATA" pins.  */
	status = "okay";

	/*  Toshiba video MIPI thing...  */
	tc358748@0e {
		compatible = "toshiba,358748", "toshiba,358746";
		reg = <0x0e>;
	};

	mma8451@1c {
		compatible = "fsl,mma8451";
		reg = <0x1c>;
		position = <1>;
		//vdd-supply = <&reg_sensor>;
		//vddio-supply = <&reg_sensor>;
	};

	/*  LTC3676 PMIC.  (Appears on schematic as LTM3676IUJ.)  */
	ltc3676@3c {
		compatible = "ltc,3676";
		reg = <0x3c>;
	};

	/*  SE95 temperature sensor.  */
	se95@48 {
		compatible = "nxp,se95";
		reg = <0x48>;
	};

	eeprom@50 {
		compatible = "atmel,24c512";
		reg = <0x50>;
		pagesize = <128>;
	};

	/*  ISL1220 RTC  */
	isl1220@6f {
		compatible = "isl,1220", "isl,1208", "isl,12022";
		reg = <0x6f>;
	};

	/*  PI7C9X2G303EL PCIe switch  */
};

&i2c2 {
	/*  All signals go out on connector J23.  */
	clock-frequency = <400000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c2_2>;	/*  "KEY COL/ROW" pins.  */
	status = "okay";

};

&i2c3 {
	/*  All signals go out on mini PCIe bus connectors.  */
	clock-frequency = <400000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c3_2>;	/*  "GPIO[36]" pins.  */
	status = "okay";

};

&i2c4 {
	/*
	 * All signals go out on connectors J19 external sensor bus
	 * and J24 audio pod.
	 */
	clock-frequency = <400000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c4_1>;	/*  "ENET TX" pins.  */
	status = "okay";

};

&usdhc3 {
	/*  FIXME: Reconfigure for 100MHz operation.  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc3_2>;
	cd-gpios = <&gpio6 11 0>;
	no-1-8-v;
	status = "okay";
};

&usdhc4 {
	/*  FIXME: Reconfigure for 100MHz operation.  */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc4_1>;
	no-1-8-v;
	status = "okay";
};

&fec {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet_4>;
	phy-mode = "rgmii";
	status = "okay";
};

&pcie {
	power-on-gpio = <&gpio3 19 0>;	/*, <&gpio1 27 0>;  */
	reset-gpio = <&gpio7 12 0>;
	wake-up-gpio = <&gpio1 5 0>;	/*, <&gpio1 7 0>;  */
	disable-gpio = <&gpio4 14 0>;	/*, <&gpio3 31 0>;  */
	status = "okay";
};

&pwm1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm1_2>;	/*  DISP0_DAT8  */
	status = "okay";
};

&pwm2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm2_1>;	/*  DISP0_DAT9  */
	status = "okay";
};

&uart1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1_1>;
	status = "okay";
};

&uart2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart2_1>;
	status = "okay";
};

&uart3 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3_2>;	/*  EIM_D{24,25}  */
	status = "okay";
};

&iomuxc {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_hog_mn>;

	ecspi1 {
		pinctrl_ecspi1_mn: ecspi1grp-mn {
			fsl,pins = <
				MX6QDL_PAD_KEY_COL1__ECSPI1_MISO	0x100b1
				MX6QDL_PAD_KEY_ROW0__ECSPI1_MOSI	0x100b1
				MX6QDL_PAD_KEY_COL0__ECSPI1_SCLK	0x100b1
				MX6QDL_PAD_GPIO_19__ECSPI1_RDY		0x100b0
				MX6QDL_PAD_KEY_ROW1__ECSPI1_SS0		0x100b0
			>;
		};
	};

	ecspi2 {
		pinctrl_ecspi2_mn: ecspi2grp-mn {
			fsl,pins = <
				MX6QDL_PAD_DISP0_DAT17__ECSPI2_MISO	0x1b0b1
				MX6QDL_PAD_DISP0_DAT16__ECSPI2_MOSI	0x1b0b1
				MX6QDL_PAD_EIM_CS0__ECSPI2_SCLK		0x1b0b1
				MX6QDL_PAD_EIM_A25__ECSPI2_RDY		0x1b0b0
				MX6QDL_PAD_EIM_RW__ECSPI2_SS0		0x1b0b0
			>;
		};
	};

	ecspi3 {
		pinctrl_ecspi3_mn: ecspi3grp-mn {
			fsl,pins = <
				MX6QDL_PAD_DISP0_DAT2__ECSPI3_MISO	0x100b1
				MX6QDL_PAD_DISP0_DAT1__ECSPI3_MOSI	0x100b1
				MX6QDL_PAD_DISP0_DAT0__ECSPI3_SCLK	0x100b1
				MX6QDL_PAD_DISP0_DAT3__ECSPI3_SS0	0x100b0
				/*  This should probably be somewhere else.  */
				MX6QDL_PAD_NANDF_CS3__GPIO6_IO16	0x100b0
			>;
		};
	};

	ecspi4 {
		pinctrl_ecspi4_mn: ecspi4grp-mn {
			fsl,pins = <
				MX6QDL_PAD_EIM_D22__ECSPI4_MISO		0x100b1
				MX6QDL_PAD_EIM_D28__ECSPI4_MOSI		0x100b1
				MX6QDL_PAD_EIM_D21__ECSPI4_SCLK		0x100b1
				MX6QDL_PAD_EIM_D20__ECSPI4_SS0		0x100b0
			>;
		};
	};

	enet {
		/*
		 * Same as pinctrl_enet_1, but with no mapping for ENET_REF_CLK
		 * or ENET_TX_EN.
		 */
		pinctrl_enet_4: enetgrp-4 {
			fsl,pins = <
				MX6QDL_PAD_ENET_MDIO__ENET_MDIO       0x1b0b0
				MX6QDL_PAD_ENET_MDC__ENET_MDC         0x1b0b0
				MX6QDL_PAD_RGMII_TXC__RGMII_TXC       0x1b0b0
				MX6QDL_PAD_RGMII_TD0__RGMII_TD0       0x1b0b0
				MX6QDL_PAD_RGMII_TD1__RGMII_TD1       0x1b0b0
				MX6QDL_PAD_RGMII_TD2__RGMII_TD2       0x1b0b0
				MX6QDL_PAD_RGMII_TD3__RGMII_TD3       0x1b0b0
				MX6QDL_PAD_RGMII_TX_CTL__RGMII_TX_CTL 0x1b0b0
				MX6QDL_PAD_ENET_REF_CLK__ENET_TX_CLK  0x1b0b0
				MX6QDL_PAD_RGMII_RXC__RGMII_RXC       0x1b0b0
				MX6QDL_PAD_RGMII_RD0__RGMII_RD0       0x1b0b0
				MX6QDL_PAD_RGMII_RD1__RGMII_RD1       0x1b0b0
				MX6QDL_PAD_RGMII_RD2__RGMII_RD2       0x1b0b0
				MX6QDL_PAD_RGMII_RD3__RGMII_RD3       0x1b0b0
				MX6QDL_PAD_RGMII_RX_CTL__RGMII_RX_CTL 0x1b0b0
			>;
		};
	};

	pwm1 {
		pinctrl_pwm1_2: pwm1grp-2 {
			fsl,pins = <
				MX6QDL_PAD_DISP0_DAT8__PWM1_OUT	0x1b0b1
			>;
		};

		pinctrl_pwm1_3: pwm1grp-3 {
			fsl,pins = <
				MX6QDL_PAD_GPIO_9__PWM1_OUT	0x1b0b1
			>;
		};
	};

	pwm2 {
		pinctrl_pwm2_1: pwm2grp-1 {
			fsl,pins = <
				MX6QDL_PAD_DISP0_DAT9__PWM2_OUT	0x1b0b1
			>;
		};

		pinctrl_pwm2_2: pwm2grp-2 {
			fsl,pins = <
				MX6QDL_PAD_GPIO_1__PWM2_OUT	0x1b0b1
			>;
		};

		pinctrl_pwm2_3: pwm2grp-3 {
			fsl,pins = <
				MX6QDL_PAD_SD1_DAT2__PWM2_OUT	0x1b0b1
			>;
		};
	};

	uart3 {
		pinctrl_uart3_2: uart3grp-2 {
			fsl,pins = <
				MX6QDL_PAD_EIM_D25__UART3_RX_DATA 0x1b0b1
				MX6QDL_PAD_EIM_D24__UART3_TX_DATA 0x1b0b1
			>;
		};
	};

	/*  Why did I do this?  */
	hog {
		pinctrl_hog_mn: hoggrp-mn {
			fsl,pins = <
				/*  SPI DUART IRQ line.  */
				MX6QDL_PAD_GPIO_0__GPIO1_IO00	0x80000000
			>;
		};
	};
//---
//	hog {
//		pinctrl_hog_2: hoggrp-2 {
//			fsl,pins = <
//				/* MAX17135 */
//				MX6QDL_PAD_EIM_A17__GPIO2_IO21 0x80000000
//				MX6QDL_PAD_EIM_D17__GPIO3_IO17 0x80000000
//				MX6QDL_PAD_EIM_D20__GPIO3_IO20 0x80000000
//				MX6QDL_PAD_EIM_A18__GPIO2_IO20 0x80000000
//				MX6QDL_PAD_EIM_OE__GPIO2_IO25 0x80000000
//				/* elan touch */
//				MX6QDL_PAD_EIM_A20__GPIO2_IO18 0x80000000
//				MX6QDL_PAD_EIM_DA8__GPIO3_IO08 0x80000000
//				MX6QDL_PAD_EIM_D28__GPIO3_IO28 0x170b0
//			>;
//		};
//	};
};
